import{k as E,J as v,p as b,G as f,c as C,q as s,a as i,t as y,w as g,a9 as _,L as o,s as a,aa as c,a8 as q,a6 as r,o as B}from"./chunks/framework.Bev6ATEH.js";import{c as T,b as x,j as P,a as t,L as k,w as Y,bW as S,b_ as A}from"./chunks/theme.DAWdUpF4.js";import{s as n}from"./chunks/sf-temperatures.CxkOsRYt.js";const V=s("h1",{id:"window-transform",tabindex:"-1"},[i("Window transform "),s("a",{class:"header-anchor",href:"#window-transform","aria-label":'Permalink to "Window transform"'},"​")],-1),j=s("p",null,[i("The "),s("strong",null,"window transform"),i(" is a specialized "),s("a",{href:"./map"},"map transform"),i(" that computes a moving window and then derives summary statistics from the current window, say to compute rolling averages, rolling minimums, or rolling maximums.")],-1),O=s("span",{style:{"border-bottom":"solid 2px var(--vp-c-red)"}},"red",-1),I=s("span",{style:{"border-bottom":"solid 2px var(--vp-c-blue)"}},"blue",-1),z={class:"label-input"},D=s("span",null,"Window size (k):",-1),N={style:{"font-variant-numeric":"tabular-nums"}},R=r("",4),X={class:"label-input"},W={style:{"margin-left":"0.5em"}},U={style:{"margin-left":"0.5em"}},L={style:{"margin-left":"0.5em"}},M=r("",3),J=s("strong",null,"strict",-1),G=s("strong",null,"anchor",-1),H=s("strong",null,"strict",-1),K=s("strong",null,"strict",-1),Q={class:"label-input"},Z=r("",3),$=r("",3),ss=r("",11),is={id:"window",tabindex:"-1"},as=s("em",null,"k",-1),ts=s("a",{class:"header-anchor",href:"#window","aria-label":'Permalink to "window(*k*) <VersionBadge version="0.2.3" /> {#window}"'},"​",-1),ns=r("",8),ks=JSON.parse('{"title":"Window transform","description":"","frontmatter":{},"headers":[],"relativePath":"transforms/window.md","filePath":"transforms/window.md"}'),es={name:"transforms/window.md"},rs=Object.assign(es,{setup(ls){const h=E(7);E(.01);const p=E("end"),u=E(!0);E("mean");const m=v([]);return b(()=>{T("../data/bls-metro-unemployment.csv",x).then(F=>m.value=F)}),(F,e)=>{const d=f("PlotRender"),w=f("VersionBadge");return B(),C("div",null,[V,j,s("p",null,[i("For example, the band chart below shows the daily high and low temperature in San Francisco. The "),O,i(" line represents the "+y(h.value)+"-day average high, and the ",1),I,i(" line the "+y(h.value)+"-day average low.",1)]),s("p",null,[s("label",z,[D,g(s("input",{type:"range","onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l),min:"1",max:"100",step:"1"},null,512),[[_,h.value,void 0,{number:!0}]]),s("span",N,y(h.value.toLocaleString("en-US")),1)])]),o(d,{options:{y:{grid:!0,label:"Temperature (°F)"},marks:[P(a(n),{x:"date",y1:"low",y2:"high",fillOpacity:.3}),t(a(n),k(h.value,{x:"date",y:"low",stroke:"var(--vp-c-blue)"})),t(a(n),k(h.value,{x:"date",y:"high",stroke:"var(--vp-c-red)"}))]}},null,8,["options"]),R,s("p",null,[s("span",X,[i(" Anchor: "),s("label",W,[g(s("input",{type:"radio",name:"anchor",value:"start","onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l)},null,512),[[c,p.value]]),i(" start ")]),s("label",U,[g(s("input",{type:"radio",name:"anchor",value:"middle","onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l)},null,512),[[c,p.value]]),i(" middle ")]),s("label",L,[g(s("input",{type:"radio",name:"anchor",value:"end","onUpdate:modelValue":e[3]||(e[3]=l=>p.value=l)},null,512),[[c,p.value]]),i(" end ")])])]),o(d,{options:{y:{grid:!0,label:"Temperature (°F)"},marks:[t(a(n),{x:"date",y:"high",strokeOpacity:.3}),t(a(n),k({k:28,anchor:p.value},{x:"date",y:"high"}))]}},null,8,["options"]),M,s("p",null,[i("If "),J,i(" is false (the default), the window size is effectively reduced at the start or end of each series or both, depending on the "),G,i(". Values computed with a truncated window may be noisy; if you would prefer to not show this data instead, set the "),H,i(" option to true. "),o(w,{version:"0.6.0"}),i(" The "),K,i(" option can also have a dramatic effect if some data is missing: when strict, the reducer will be skipped if any of the values in the current window are null, undefined, or NaN.")]),s("p",null,[s("label",Q,[i(" Strict: "),g(s("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=l=>u.value=l)},null,512),[[q,u.value]])])]),o(d,{options:{y:{grid:!0,label:"Temperature (°F)"},marks:[t(a(n),{x:"date",y:"low",strokeOpacity:.3}),t(a(n),k({k:28,anchor:"end",strict:u.value},{x:"date",y:"low"}))]}},null,8,["options"]),Z,o(d,{options:{y:{grid:!0,label:"Temperature (°F)"},marks:[t(a(n),{x:"date",y:"low",strokeOpacity:.3}),t(a(n),k({k:28,reduce:"min"},{x:"date",y:"low",stroke:"var(--vp-c-blue)"})),t(a(n),k({k:28,reduce:"max"},{x:"date",y:"low",stroke:"var(--vp-c-red)"})),t(a(n),k({k:28,reduce:"median"},{x:"date",y:"low"}))]}},null,8,["options"]),$,o(d,{defer:"",options:{y:{grid:!0},color:{scheme:"BuYlRd",domain:[-.5,.5]},marks:[Y([0]),t(m.value,S({stroke:A({k:2,reduce:"difference"})},{x:"date",y:"unemployment",z:"division",stroke:"unemployment"}))]}},null,8,["options"]),ss,s("h2",is,[i("window("),as,i(") "),o(w,{version:"0.2.3"}),i(),ts]),ns])}}});export{ks as __pageData,rs as default};
