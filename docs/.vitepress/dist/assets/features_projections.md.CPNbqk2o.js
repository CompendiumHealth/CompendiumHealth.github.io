import{k as F,m as u,J as p,p as V,G as w,c as D,q as s,a as i,L as o,w as f,a9 as T,t as _,a7 as N,a6 as l,o as R}from"./chunks/framework.Bev6ATEH.js";import{z as y,A as z,b as U,B as n,C as P,e as A,D as b,f as x,E as M,F as W}from"./chunks/theme.DAWdUpF4.js";import{f as S}from"./chunks/feature.DXDMwmIR.js";import{m as G}from"./chunks/mesh.DUGB6pHu.js";const L={id:"projections",tabindex:"-1"},H=s("a",{class:"header-anchor",href:"#projections","aria-label":'Permalink to "Projections <VersionBadge version="0.6.1" />"'},"​",-1),J=s("p",null,[i("A "),s("strong",null,"projection"),i(" maps abstract coordinates in "),s("em",null,"x"),i(" and "),s("em",null,"y"),i(" to pixel positions on screen. Most often, abstract coordinates are spherical (degrees longitude and latitude), as when rendering a geographic map. For example, below we show earthquakes in the last seven days with a magnitude of 2.5 or higher as reported by the "),s("a",{href:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/geojson.php",target:"_blank",rel:"noreferrer"},"USGS"),i(". Use the slider to adjust the "),s("em",null,"orthographic"),i(" projection’s center of longitude.")],-1),Y={class:"label-input"},$={style:{"font-variant-numeric":"tabular-nums"}},K=l(`<a class="plot-fork no-icon" href="https://observablehq.com/@observablehq/plot-earthquake-globe?intent=fork" target="_blank" title="Open on Observable">Fork</a><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  projection: {type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;orthographic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rotate: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">longitude, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  r: {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">transform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, d)}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// convert Richter to amplitude</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marks: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(land, {fill: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;currentColor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fillOpacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sphere</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(earthquakes, {x: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;longitude&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;latitude&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, r: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;magnitude&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stroke: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;red&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fill: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;red&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fillOpacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Above, a <a href="./../marks/geo">geo mark</a> draws polygons representing land and a <a href="./../marks/geo#sphere">sphere mark</a> draws the outline of the globe. A <a href="./../marks/dot">dot mark</a> draws earthquakes as circles sized by magnitude.</p><p>The geo mark is “projection aware” so that it can handle all the nuances of projecting spherical polygons to the screen — leaning on <a href="https://d3js.org/d3-geo" target="_blank" rel="noreferrer">d3-geo</a> to provide <a href="https://observablehq.com/@d3/adaptive-sampling" target="_blank" rel="noreferrer">adaptive sampling</a> with configurable precision, <a href="https://observablehq.com/@d3/antimeridian-cutting" target="_blank" rel="noreferrer">antimeridian cutting</a>, and clipping. The dot mark is not; instead, Plot applies the projection in place of the <em>x</em> and <em>y</em> scales. Hence, projections work with any mark that consumes continuous <strong>x</strong> and <strong>y</strong> channels — as well as marks that use <strong>x1</strong> &amp; <strong>y1</strong> and <strong>x2</strong> &amp; <strong>y2</strong>. Each mark implementation decides whether to handle projections specially or to treat the projection as any other position scale. (For example, the <a href="./../marks/line">line mark</a> is projection-aware to draw geodesics.)</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Marks that require <em>band</em> scales (bars, cells, and ticks) cannot be used with projections. Likewise one-dimensional marks such as rules cannot be used, though see <a href="https://github.com/observablehq/plot/issues/1164" target="_blank" rel="noreferrer">#1164</a>.</p></div><p>Plot provides a variety of built-in projections. And as above, all world projections can be rotated to show a different aspect.</p>`,6),Q={class:"label-input"},X=l("<option>azimuthal-equal-area</option><option>azimuthal-equidistant</option><option>conic-equal-area</option><option>conic-equidistant</option><option>equal-earth</option><option>equirectangular</option><option>gnomonic</option><option>mercator</option><option>orthographic</option><option>stereographic</option><option>transverse-mercator</option>",11),Z=[X],ss=s("a",{class:"plot-fork no-icon",href:"https://observablehq.com/@observablehq/plot-world-projections?intent=fork",target:"_blank",title:"Open on Observable"},"Fork",-1),is={class:"language-js vp-adaptive-theme"},as=s("button",{title:"Copy Code",class:"copy"},null,-1),ts=s("span",{class:"lang"},"js",-1),es={class:"shiki shiki-themes github-light github-dark vp-code"},ns=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Plot."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"plot"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")],-1),ls={class:"line"},os=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  projection: ",-1),hs={style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},rs=s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",",-1),ps=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  marks: [")],-1),ks=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Plot."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"graticule"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),")],-1),Es=l('<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(land, {fill: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;currentColor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}),</span></span>',1),ds=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Plot."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sphere"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")],-1),cs=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")],-1),gs=s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})")],-1),us=l("<p>Why so many? Each projection has its strengths and weaknesses:</p><ul><li><em>conformal</em> projections preserve angles and local shape,</li><li><em>equal-area</em> projections preserve area (use these for choropleths),</li><li><em>equidistant</em> projections preserve distance from one (or two) points,</li><li><em>azimuthal</em> projections expand radially from a central feature,</li><li><em>cylindrical</em> projections have symmetry around the axis of rotation,</li><li>the <em>stereographic</em> projection preserves circles, and</li><li>the <em>gnomonic</em> projection displays all great circles as straight lines!</li></ul><p>No single projection is best at everything. It is impossible, for example, for a projection to be both conformal and equal-area.</p><p>In addition to world projections, Plot provides the U.S.-centric <em>albers-usa</em> conic equal-area projection with an inset of Alaska and Hawaii. (Note that the scale for Alaska is diminished: it is projected at 0.35× its true relative area.)</p>",4),ys=l(`<a class="plot-fork no-icon" href="https://observablehq.com/@observablehq/plot-albers-usa-projection?intent=fork" target="_blank" title="Open on Observable">Fork</a><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  projection: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;albers-usa&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marks: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nation),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(statemesh, {strokeOpacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Use the <em>albers-usa</em> projection for U.S.-centric choropleth maps.</p></div><p>For maps that focus on a specific region, use the <strong>domain</strong> option to zoom in. This object should be a GeoJSON object. For example, you can use <a href="https://d3js.org/d3-geo/shape#geoCircle" target="_blank" rel="noreferrer">d3.geoCircle</a> to generate a circle of a given radius centered at a given longitude and latitude. You can also use the <strong>inset</strong> options for a bit of padding around the <strong>domain</strong>.</p>`,4),ms={class:"label-input"},Fs={style:{"font-variant-numeric":"tabular-nums"}},fs=l(`<a class="plot-fork no-icon" href="https://observablehq.com/@observablehq/plot-projection-domain?intent=fork" target="_blank" title="Open on Observable">Fork</a><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  projection: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;azimuthal-equidistant&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rotate: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">34</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    domain: circle,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    inset: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marks: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">graticule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(land, {fill: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;currentColor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fillOpacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(circle, {stroke: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;red&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strokeWidth: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">frame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">circle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d3.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geoCircle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">34</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">radius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(radius)()</span></span></code></pre></div><p>If none of Plot’s built-in projections meet your needs, you can use any of <a href="https://github.com/d3/d3-geo-projection" target="_blank" rel="noreferrer">D3’s extended projections</a> by specifying the <strong>projection</strong> option as a function that returns a D3 projection. Below, a map of Antarctica in a polar aspect of the <em>azimuthal-equidistant</em> projection.</p>`,4),_s=l(`<a class="plot-fork no-icon" href="https://observablehq.com/@observablehq/plot-polar-projection?intent=fork" target="_blank" title="Open on Observable">Fork</a><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  width: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">688</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  height: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">688</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  projection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: ({</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d3.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geoAzimuthalEquidistant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rotate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">translate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scale</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(width)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clipAngle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marks: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">graticule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(land, {fill: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;currentColor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">frame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>While this notebook mostly details spherical projections, you can use the <em>identity</em> projection to display planar geometry. For example, below we draw a schematic of the second floor of the <a href="https://en.wikipedia.org/wiki/Westport_House" target="_blank" rel="noreferrer">Westport House</a> in Dundee, Ireland.</p>`,3),bs=l('<a class="plot-fork no-icon" href="https://observablehq.com/@observablehq/plot-floor-plan?intent=fork" target="_blank" title="Open on Observable">Fork</a><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(westport).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({projection: {type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;identity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, domain: westport}})</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>There’s also a <em>reflect-y</em> projection in case <em>y</em> points up↑, which is often the case with <a href="https://en.wikipedia.org/wiki/Projected_coordinate_system" target="_blank" rel="noreferrer">projected reference systems</a>.</p></div><p>Naturally, Plot’s projection system is compatible with its <a href="./facets">faceting system</a>. Below, a comic strip of sorts shows the locations of Walmart store openings in past decades.</p>',4),vs=l(`<a class="plot-fork no-icon" href="https://observablehq.com/@observablehq/plot-map-small-multiples?intent=fork" target="_blank" title="Open on Observable">Fork</a><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marginLeft: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marginRight: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  projection: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;albers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  fx: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    interval: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;10 years&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    tickFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUTCFullYear</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}’s\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    label: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  marks: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(statemesh, {strokeOpacity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nation),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Plot.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(walmarts, {fx: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;date&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;longitude&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, y: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;latitude&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, r: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fill: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;currentColor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This uses the <a href="./scales#scale-transforms"><strong>interval</strong> scale option</a> to bin temporal data into facets by decade.</p></div><p>To learn more about mapping with Plot, see our hands-on tutorials:</p><ul><li><a href="https://observablehq.com/@observablehq/build-your-first-map-with-observable-plot" target="_blank" rel="noreferrer">Build your first map with Observable Plot</a></li><li><a href="https://observablehq.com/@observablehq/build-your-first-choropleth-map-with-observable-plot" target="_blank" rel="noreferrer">Build your first choropleth map with Observable Plot</a></li></ul><h2 id="projection-options" tabindex="-1">Projection options <a class="header-anchor" href="#projection-options" aria-label="Permalink to &quot;Projection options&quot;">​</a></h2><p>The <strong>projection</strong> <a href="./plots">plot option</a> applies a two-dimensional (often geographic) projection in place of <strong>x</strong> and <strong>y</strong> scales. It is typically used in conjunction with a <a href="./../marks/geo">geo mark</a> to produce a map, but can be used with any mark that supports <strong>x</strong> and <strong>y</strong> channels, such as <a href="./../marks/dot">dot</a>, <a href="./../marks/text">text</a>, <a href="./../marks/arrow">arrow</a>, and <a href="./../marks/rect">rect</a>. For marks that use <strong>x1</strong>, <strong>y1</strong>, <strong>x2</strong>, and <strong>y2</strong> channels, the two projected points are ⟨<em>x1</em>, <em>y1</em>⟩ and ⟨<em>x2</em>, <em>y2</em>⟩; otherwise, the projected point is ⟨<em>x</em>, <em>y</em>⟩.</p><p>The following built-in named projections are supported:</p><ul><li><em>equirectangular</em> - the equirectangular, or <em>plate carrée</em>, projection</li><li><em>orthographic</em> - the orthographic projection</li><li><em>stereographic</em> - the stereographic projection</li><li><em>mercator</em> - the Mercator projection</li><li><em>equal-earth</em> - the <a href="https://en.wikipedia.org/wiki/Equal_Earth_projection" target="_blank" rel="noreferrer">Equal Earth projection</a> by Šavrič <em>et al.</em></li><li><em>azimuthal-equal-area</em> - the azimuthal equal-area projection</li><li><em>azimuthal-equidistant</em> - the azimuthal equidistant projection</li><li><em>conic-conformal</em> - the conic conformal projection</li><li><em>conic-equal-area</em> - the conic equal-area projection</li><li><em>conic-equidistant</em> - the conic equidistant projection</li><li><em>gnomonic</em> - the gnomonic projection</li><li><em>transverse-mercator</em> - the transverse Mercator projection</li><li><em>albers</em> - the Albers’ conic equal-area projection</li><li><em>albers-usa</em> - a composite Albers conic equal-area projection suitable for the United States</li><li><em>identity</em> - the identity projection for planar geometry</li><li><em>reflect-y</em> - like the identity projection, but <em>y</em> points up</li><li>null (default) - the null projection for pre-projected geometry in screen coordinates</li></ul><p>In addition to these named projections, the <strong>projection</strong> option may be specified as a <a href="https://d3js.org/d3-geo/projection" target="_blank" rel="noreferrer">D3 projection</a>, or any custom projection that implements <a href="https://d3js.org/d3-geo/stream" target="_blank" rel="noreferrer"><em>projection</em>.stream</a>, or a function that receives a configuration object ({<em>width</em>, <em>height</em>, ...<em>options</em>}) and returns such a projection. In the last case, the width and height represent the frame dimensions minus any insets.</p><p>If the <strong>projection</strong> option is specified as an object, the following additional projection options are supported:</p><ul><li><strong>type</strong> - one of the projection names above</li><li><strong>parallels</strong> - the <a href="https://d3js.org/d3-geo/conic#conic_parallels" target="_blank" rel="noreferrer">standard parallels</a> (for conic projections only)</li><li><strong>precision</strong> - the <a href="https://d3js.org/d3-geo/projection#projection_precision" target="_blank" rel="noreferrer">sampling threshold</a></li><li><strong>rotate</strong> - a two- or three- element array of Euler angles to rotate the sphere</li><li><strong>domain</strong> - a GeoJSON object to fit in the center of the (inset) frame</li><li><strong>inset</strong> - inset by the given amount in pixels when fitting to the frame (default zero)</li><li><strong>insetLeft</strong> - inset from the left edge of the frame (defaults to inset)</li><li><strong>insetRight</strong> - inset from the right edge of the frame (defaults to inset)</li><li><strong>insetTop</strong> - inset from the top edge of the frame (defaults to inset)</li><li><strong>insetBottom</strong> - inset from the bottom edge of the frame (defaults to inset)</li><li><strong>clip</strong> - the projection clipping method</li></ul><p>The following projection clipping methods are supported for <strong>clip</strong>:</p><ul><li><em>frame</em> or true (default) - clip to the extent of the frame (including margins but not insets)</li><li>a number - clip to a great circle of the given radius in degrees centered around the origin</li><li>null or false - do not clip</li></ul><p>Whereas the <strong>clip</strong> <a href="./marks#mark-options">mark option</a> is implemented using SVG clipping, the <strong>clip</strong> projection option affects the generated geometry and typically produces smaller SVG output.</p>`,15),Ps=JSON.parse('{"title":"Projections","description":"","frontmatter":{},"headers":[],"relativePath":"features/projections.md","filePath":"features/projections.md"}'),Cs={name:"features/projections.md"},As=Object.assign(Cs,{setup(js){const k=F(90),E=F(30),v=u(()=>W().center([9,34]).radius(E.value)()),d=F("equirectangular"),m=p({type:null}),C=p([]),j=p([]),c=p(null),g=u(()=>c.value?S(c.value,c.value.objects.land):{type:null}),h=p(null),q=u(()=>h.value?S(h.value,h.value.objects.nation):{type:null}),B=u(()=>h.value?G(h.value,h.value.objects.states,(a,t)=>a!==t):{type:null});return V(()=>{y("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.geojson").then(a=>C.value=a.features.map(t=>({longitude:t.geometry.coordinates[0],latitude:t.geometry.coordinates[1],magnitude:t.properties.mag}))),y("../data/countries-110m.json").then(a=>c.value=a),z("../data/walmarts.tsv",U).then(a=>j.value=a),y("../data/westport-house.json").then(a=>m.value=a),y("../data/us-counties-10m.json").then(a=>h.value=a)}),(a,t)=>{const O=w("VersionBadge"),r=w("PlotRender");return R(),D("div",null,[s("h1",L,[i("Projections "),o(O,{version:"0.6.1"}),i(),H]),J,s("p",null,[s("label",Y,[i(" Longitude: "),f(s("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e),min:"-180",max:"180",step:"1"},null,512),[[T,k.value,void 0,{number:!0}]]),s("span",$,_(k.value)+"°",1)])]),o(r,{defer:"",options:{projection:{type:"orthographic",rotate:[-k.value,-30]},r:{transform:e=>Math.pow(10,e)},marks:[n(g.value,{fill:"currentColor",fillOpacity:.2}),P(),A(C.value,{x:"longitude",y:"latitude",r:"magnitude",stroke:"var(--vp-c-red)",fill:"var(--vp-c-red)",fillOpacity:.2})]}},null,8,["options"]),K,s("p",null,[s("label",Q,[i(" Projection: "),f(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e)},Z,512),[[N,d.value]])])]),o(r,{defer:"",options:{projection:d.value,marks:[b(),n(g.value,{fill:"currentColor"}),P()]}},null,8,["options"]),ss,s("div",is,[as,ts,s("pre",es,[s("code",null,[ns,i(`
`),s("span",ls,[os,s("span",hs,'"'+_(d.value)+'"',1),rs]),i(`
`),ps,i(`
`),ks,i(`
`),Es,i(`
`),ds,i(`
`),cs,i(`
`),gs])])]),us,o(r,{defer:"",options:{projection:"albers-usa",marks:[n(q.value),n(B.value,{strokeOpacity:.2})]}},null,8,["options"]),ys,s("p",null,[s("label",ms,[i(" Radius: "),f(s("input",{type:"range","onUpdate:modelValue":t[2]||(t[2]=e=>E.value=e),min:"10",max:"50",step:"0.1"},null,512),[[T,E.value,void 0,{number:!0}]]),s("span",Fs,_(E.value.toFixed(1))+"°",1)])]),o(r,{defer:"",options:{projection:{type:"azimuthal-equidistant",rotate:[-9,-34],domain:v.value,inset:10},marks:[b(),n(g.value,{fill:"currentColor",fillOpacity:.3}),n(v.value,{stroke:"var(--vp-c-red)",strokeWidth:2}),x()]}},null,8,["options"]),fs,o(r,{defer:"",options:{width:688,height:688,projection:({width:e,height:I})=>M().rotate([0,90]).translate([e/2,I/2]).scale(e).clipAngle(40),marks:[b(),n(g.value,{fill:"currentColor"}),x()]}},null,8,["options"]),_s,o(r,{defer:"",mark:n(m.value),options:{projection:{type:"identity",domain:m.value}}},null,8,["mark","options"]),bs,o(r,{defer:"",options:{marginLeft:0,marginRight:0,projection:"albers",fx:{interval:"10 years",tickFormat:e=>`${e.getUTCFullYear()}’s`,label:null},marks:[n(B.value,{strokeOpacity:.1}),n(q.value),A(j.value,{fx:"date",x:"longitude",y:"latitude",r:1,fill:"currentColor"})]}},null,8,["options"]),vs])}}});export{Ps as __pageData,As as default};
